function xtract_is_denormal(t){return Math.abs(t)<=2.2250738585072014e-308}function xtract_assert_array(t){return"object"==typeof t&&void 0!==t.length&&t.length>0}function xtract_assert_positive_integer(t){return"number"==typeof t&&t>=0&&t===Math.round(t)}function xtract_array_sum(t){if(!xtract_assert_array(t))return 0;if(t.reduce)return t.reduce(function(t,r){return t+r},0);for(var r=0,e=t.length,a=0;a<e;a++)r+=t[a];return r}function xtract_array_copy(t){for(var r=t.length,e=new t.constructor(r),a=0;a<r;a++)e[a]=t[a];return e}function xtract_array_min(t){if(!xtract_assert_array(t))return 1/0;if(t.reduce)return t.reduce(function(t,r){return r<t?r:t},t[0]);for(var r=1/0,e=t.length,a=0;a<e;a++)t[a]<r&&(r=t[a]);return r}function xtract_array_max(t){if(!xtract_assert_array(t))return-1/0;if(t.reduce)return t.reduce(function(t,r){return r>t?r:t},t[0]);for(var r=t[0],e=t.length,a=1;a<e;a++)t[a]>r&&(r=t[a]);return r}function xtract_array_scale(t,r){if(!xtract_assert_array(t))return 0;if("number"!=typeof r)return 0;var e=0,a=t.length;for(e=0;e<a;e++)t[e]*=r;return t}function xtract_array_normalise(t){return xtract_assert_array(t)?xtract_array_scale(t,1/xtract_array_max(t)):0}function xtract_array_bound(t,r,e){if(!xtract_assert_array(t))return 0;if("number"!=typeof r&&(r=xtract_array_min(t)),"number"!=typeof e&&(e=xtract_array_max(t)),r>=e)throw"Invalid boundaries! Minimum cannot be greater than maximum";for(var a=new t.constructor(t.length),n=0;n<t.length;n++)a[n]=Math.min(Math.max(t[n],r),e);return a}function xtract_array_interlace(t){if(!xtract_assert_array(t))return[];var r=t.length,e=t[0].length;if(!1===t.every(function(t){return t.length===e}))throw"All argument lengths must be the same";for(var a=new t[0].constructor(r*e),n=0;n<e;n++)for(var s=0;s<r;s++)a[n*r+s]=t[s][n];return a}function xtract_array_deinterlace(t,r){if(!xtract_assert_array(t))return[];var e,a;if(!xtract_assert_positive_integer(r))throw"num_arrays must be a positive integer";e=[],a=t.length/r;for(var n=0;n<r;n++)e[n]=new t.constructor(a);for(var s=0;s<a;s++)for(var i=0;i<r;i++)e[i][s]=t[s*r+i];return e}function xtract_get_number_of_frames(t,r){if(!xtract_assert_array(t))throw"Invalid data parameter. Must be item with iterable list";if("number"!=typeof r&&r<=0)throw"Invalid hop_size. Must be positive integer";return Math.floor(t.length/r)}function xtract_get_data_frames(t,r,e,a){void 0===e&&(e=r),function(r,e,a){if(!xtract_assert_array(t))throw"Invalid data parameter. Must be item with iterable list";if(!xtract_assert_positive_integer(e))throw"xtract_get_data_frames requires the frame_size to be a positive integer";if(!xtract_assert_positive_integer(a))throw"xtract_get_data_frames requires the hop_size to be a positive integer"}(0,r,e);for(var n,s=[],i=t.length,u=Math.ceil(i/e),o=0;o<u;o++){var c=o*e;if(a){n=new Float64Array(r);for(var f=0;f<r&&f+c<t.length;f++)n[f]=t[f+c]}else if((n=t.subarray(c,c+r)).length<r){for(var l=new Float64Array(r),m=0;m<n.length;m++)l[m]=n[m];n=l}s.push(n)}return s}function xtract_process_frame_data(t,r,e,a,n,s){for(var i,u,o=xtract_get_data_frames(t,a,n),c={num_frames:o.length,results:[]},f=0,l={frame_size:a,hop_size:n,sample_rate:e,TimeData:void 0,SpectrumData:void 0},m=0;m<o.length;m++){var h=o[m];l.TimeData=h,l.SpectrumData=xtract_spectrum(h,e,!0,!1);var _={time_start:f,result:u=r.call(s||this,l,i,u)};f+=a/e,i=l,l={frame_size:a,hop_size:n,sample_rate:e,TimeData:void 0,SpectrumData:void 0},c.results.push(_)}return c}function xtract_array_to_JSON(t){if(t.join)return"["+t.join(", ")+"]";for(var r="[",e=0;e<this.length;)r+=this[e],void 0!==this[e+1]&&(r+=","),e++;return r+"]"}function xtract_frame_from_array(t,r,e,a,n){void 0===n&&(n=a),function(t,r,a,n,s){if(!xtract_assert_positive_integer(e))throw"xtract_get_frame requires the index to be an integer value";if(!xtract_assert_positive_integer(r))throw"xtract_get_frame requires the frame_size to be a positive integer";if(!xtract_assert_array(a))throw"Invalid data parameter. Must be item with iterable list";if(!xtract_assert_array(n))throw"dst must be an Array-like object equal in length to frame_size";if(!xtract_assert_positive_integer(s))throw"xtract_get_frame requires the hop_size to be a positive integer"}(0,a,t,r,n);if(e>=xtract_get_number_of_frames(t,n))throw"index number "+e+" out of bounds";for(var s=0,i=e*n;s<r.length&&s<t.length&&s<a;)r[s]=t[s+i],s++;for(;s<r.length;)r[s]=0}function xtract_mean(t){return xtract_assert_array(t)?xtract_array_sum(t)/t.length:0}function xtract_temporal_centroid(t,r,e){if("number"==typeof r){"number"!=typeof e&&(console.log("xtract_temporal_centroid assuming window_ms = 100ms"),e=100),e<=0&&(e=100);for(var a=1/r,n=r*(e/1e3),s=xtract_array_sum(t),i=0,u=0;u<t.length;u++)i+=t[u]*(u*n*a);return i/s}console.error("xtract_temporal_centroid requires sample_rate to be a number")}function xtract_variance(t,r){if(!xtract_assert_array(t))return 0;"number"!=typeof r&&(r=xtract_mean(t));var e=0;if(t.reduce)e=t.reduce(function(t,e){return t+=Math.pow(e-r,2)},0);else for(var a=0;a<t.length;a++)e+=Math.pow(t[a]-r,2);return e/=t.length-1}function xtract_standard_deviation(t,r){return xtract_assert_array(t)?("number"!=typeof r&&(r=xtract_variance(t)),Math.sqrt(r)):0}function xtract_average_deviation(t,r){if(!xtract_assert_array(t))return 0;"number"!=typeof r&&(r=xtract_mean(t));var e=0;if(t.reduce)e=t.reduce(function(t,e){return t+Math.abs(e-r)},0);else for(var a=0;a<t.length;a++)e+=Math.abs(t[a]-r);return e/t.length}function xtract_skewness_kurtosis(t,r,e){if(!xtract_assert_array(t))return[0,0];if("number"!=typeof r&&(r=xtract_mean(t)),"number"!=typeof e&&(e=xtract_standard_deviation(t,xtract_variance(t,r))),0===e)return[0,0];for(var a=[0,0],n=0;n<t.length;n++)a[0]+=Math.pow((t[n]-r)/e,3),a[1]+=Math.pow((t[n]-r)/e,4);return a[0]/=t.length,a[1]/=t.length,a}function xtract_skewness(t,r,e){return xtract_skewness_kurtosis(t,r,e)[0]}function xtract_kurtosis(t,r,e){return xtract_skewness_kurtosis(t,r,e)[1]}function xtract_spectral_centroid(t){if(!xtract_assert_array(t))return 0;var r=t.length>>1,e=t.subarray(0,r),a=t.subarray(r),n=xtract_array_sum(e);if(0===n)return 0;for(var s=0;r--;)s+=a[r]*(e[r]/n);return s}function xtract_spectral_mean(t){if(!xtract_assert_array(t))return 0;var r=t.length>>1;return xtract_array_sum(t.subarray(0,r))/r}function xtract_spectral_variance(t,r){if(!xtract_assert_array(t))return 0;"number"!=typeof r&&(r=xtract_spectral_centroid(t));for(var e=0,a=t.length,n=a>>1,s=t.subarray(0,n),i=t.subarray(n,a),u=xtract_array_sum(s);n--;)e+=Math.pow(i[n]-r,2)*(s[n]/u);return e}function xtract_spectral_spread(t,r){return xtract_spectral_variance(t,r)}function xtract_spectral_standard_deviation(t,r){return xtract_assert_array(t)?("number"!=typeof r&&(r=xtract_spectral_variance(t)),Math.sqrt(r)):0}function xtract_spectral_skewness(t,r,e){if(!xtract_assert_array(t))return 0;if("number"!=typeof spectral_mean&&(r=xtract_spectral_centroid(t)),"number"!=typeof e&&(e=xtract_spectral_standard_deviation(t,xtract_spectral_variance(t,r))),0===e)return 0;for(var a=0,n=t.length>>1,s=t.subarray(0,n),i=t.subarray(n),u=xtract_array_sum(s),o=0;o<n;o++)a+=Math.pow(i[o]-r,3)*(s[o]/u);return a/=Math.pow(e,3)}function xtract_spectral_kurtosis(t,r,e){if(!xtract_assert_array(t))return 0;if("number"!=typeof r&&(r=xtract_spectral_centroid(t)),"number"!=typeof e&&(e=xtract_spectral_standard_deviation(t,xtract_spectral_variance(t,r))),0===e)return 1/0;for(var a=0,n=t.length>>1,s=t.subarray(0,n),i=t.subarray(n),u=xtract_array_sum(s),o=0;o<n;o++)a+=Math.pow(i[o]-r,4)*(s[o]/u);return a/Math.pow(e,4)}function xtract_irregularity_k(t){if(!xtract_assert_array(t))return 0;for(var r=0,e=t.length>>1,a=t.subarray(0,e),n=1;n<e-1;n++)r+=Math.abs(Math.log10(a[n])-Math.log10(a[n-1]+a[n]+a[n+1])/3);return r}function xtract_irregularity_j(t){if(!xtract_assert_array(t))return 0;for(var r=0,e=0,a=t.length>>1,n=t.subarray(0,a),s=0;s<a-1;s++)r+=Math.pow(n[s]-n[s+1],2),e+=Math.pow(n[s],2);return r/e}function xtract_tristimulus(t,r){var e=[0,0,0];if(!xtract_assert_array(t))return e;if("number"!=typeof r)throw"xtract_tristimulus requires f0 to be defined and a number";for(var a=0,n=[0,0,0,0,0],s=0,i=t.length>>1,u=t.subarray(0,i),o=t.subarray(i),c=0;c<i;c++)0!==(s=u[c])&&(a+=s,n[Math.floor(o[c]/r+.5)-1]+=s);return 0!==a&&(e[0]=n[0]/a,e[1]=(n[1]+n[2]+n[3])/a,e[2]=n[4]/a),e}function xtract_tristimulus_1(t,r){return xtract_tristimulus(t,r)[0]}function xtract_tristimulus_2(t,r){return xtract_tristimulus(t,r)[1]}function xtract_tristimulus_3(t,r){return xtract_tristimulus(t,r)[2]}function xtract_smoothness(t){if(!xtract_assert_array(t))return 0;var r=0,e=0,a=0,n=0,s=t.length>>1;r=Math.max(1e-5,t[0]),e=Math.max(1e-5,t[1]);for(var i=1;i<s-1;i++)a=Math.max(1e-5,t[i+1]),n+=Math.abs(20*Math.log(e)-(20*Math.log(r)+20*Math.log(e)+20*Math.log(a))/3),r=e,e=a;return n}function xtract_zcr(t){if(!xtract_assert_array(t))return 0;for(var r=0,e=1;e<t.length;e++)t[e]*t[e-1]<0&&r++;return r/t.length}function xtract_rolloff(t,r,e){if(!xtract_assert_array(t))return 0;if("number"!=typeof r||"number"!=typeof e)return console.log("xtract_rolloff requires sampleRate and threshold to be defined"),null;var a=t.length>>1,n=t.subarray(0,a),s=0,i=0;s=xtract_array_sum(n),s*=e/100;for(var u=0;i<s;)i+=n[u],u++;return u*(r/t.length)}function xtract_loudness(t){if(!xtract_assert_array(t))return 0;var r=0;if(t.reduce)r=t.reduce(function(t,r){return t+Math.pow(r,.23)},0);else for(var e=0;e<t.length;e++)r+=Math.pow(t[e],.23);return r}function xtract_flatness(t){if(!xtract_assert_array(t))return 0;for(var r=0,e=1,a=0,n=0,s=t.length>>1,i=t.subarray(0,s),u=0;u<s;u++)e*=n=Math.max(1e-32,i[u]),a+=n,r++;return 0===r?0:(e=Math.pow(e,1/r),a/=r,e/a)}function xtract_flatness_db(t,r){return xtract_assert_array(t)?("number"!=typeof r&&(r=xtract_flatness(t)),10*Math.log10(r)):0}function xtract_tonality(t,r){return xtract_assert_array(t)?("number"!=typeof r&&(r=xtract_flatness_db(t)),Math.min(r/-60,1)):0}function xtract_crest(t,r,e){return xtract_assert_array(t)?("number"!=typeof r&&(r=xtract_array_max(t)),"number"!=typeof e&&(e=xtract_mean(t)),r/e):0}function xtract_noisiness(t,r){return"number"!=typeof t&&"number"!=typeof r?0:(r-t)/r}function xtract_rms_amplitude(t){if(!xtract_assert_array(t))return 0;var r=0;if(t.reduce)r=t.reduce(function(t,r){return t+r*r},0);else for(var e=0;e<t.length;e++)r+=t[e]*t[e];return Math.sqrt(r/t.length)}function xtract_spectral_inharmonicity(t,r){if(!xtract_assert_array(t))return 0;if("number"!=typeof r)return console.error("spectral_inharmonicity requires f0 to be defined."),null;for(var e=0,a=0,n=0,s=t.length>>1,i=t.subarray(0,o),u=t.subarray(o),o=0;o<s;o++)if(0!==i[o]){e=Math.floor(u[o]/r+.5);var c=Math.pow(i[o],2);a+=Math.abs(u[o]-e*r)*c,n+=c}return 2*a/(r*n)}function xtract_power(t){return null}function xtract_odd_even_ratio(t,r){if(!xtract_assert_array(t))return 0;!function(t){if("number"!=typeof r)throw"spectral_inharmonicity requires f0 to be defined."}();for(var e,a=0,n=0,s=t.length>>1,i=t.subarray(0,o),u=t.subarray(o),o=0;o<s;o++)0!==(e=i[o])&&(Math.floor(u[o]/r+.5)%2!=0?a+=e:n+=e);return 0===a||0===n?0:a/n}function xtract_sharpness(t){if(!xtract_assert_array(t))return 0;for(var r=t.length,e=0,a=0,n=0;n<r;n++)e=Math.pow(t[n],.23),a+=n*(n<15?1:.066*Math.exp(.171*n))*e;return a=.11*a/r}function xtract_spectral_slope(t){if(!xtract_assert_array(t))return 0;var r=0,e=0,a=0,n=0,s=t.length>>1,i=t.subarray(0,s),u=t.subarray(s);r=xtract_array_sum(u),a=xtract_array_sum(i);for(var o=0;o<s;o++)e+=u[o]*i[o],n+=u[o]*u[o];return 1/a*(s*e-r*a)/(s*n-r*r)}function xtract_lowhigh(t,r){for(var e={min:null,max:null},a=0;a<t.length;a++)t[a]>r&&(e.min=Math.min(e.min,t[a])),t[a]<r&&(e.max=Math.max(e.max,t[a]));return e}function xtract_lowest_value(t,r){return xtract_assert_array(t)?("number"!=typeof r&&(r=-1/0),xtract_lowhigh(t,r).min):0}function xtract_highest_value(t,r){return xtract_assert_array(t)?("number"!=typeof r&&(r=1/0),xtract_lowhigh(t,r).max):0}function xtract_sum(t){return xtract_assert_array(t)?xtract_array_sum(t):0}function xtract_nonzero_count(t){if(!xtract_assert_array(t))return 0;var r=0;if(t.reduce)return t.reduce(function(t,r){return 0!==r&&t++,t});for(var e=0;e<t.length;e++)0!==t[e]&&r++;return r}function xtract_hps(t){if(!xtract_assert_array(t))return 0;var r,e=0,a=0,n=0,s=0,i=t.length>>1,u=t.subarray(0,i),o=t.subarray(i),c=Math.ceil(i/3);if(c<=1)throw"Input Data is too short for HPS";for(e=function(t,r){var e=0,a=0,n=new Float64Array(t);return n.forEach(function(t,e,a){a[e]=r[e]*r[2*e]*r[3*e]}),n.forEach(function(t,r){t>a&&(a=t,e=r)}),e}(c,u),r=0;r<i;r++)u[r]>n&&r!==e&&(n=u[r],a=r);return s=u[a]/u[e],a>.4*e&&a<.6*e&&s>.1&&(e=a),o[e]}function xtract_f0(t,r){function e(t,r,e){var a,n=0;for(a=1;a<r;a++)n+=Math.abs(t[a]-t[a+e]);return n}if(!xtract_assert_array(t))return 0;"number"!=typeof r&&(r=44100);var a=xtract_array_copy(t),n=a.length/2,s=.8,i=.3,u=0;u=xtract_array_max(a),i*=u,(a=xtract_array_bound(a,-(s*=u),s)).forEach(function(t,r,e){e[r]=Math.max(0,t-i)});for(var o=e(a,n,1),c=2;c<n;c++){var f=e(a,n,c);if(f<o)return r/(c+f/o)}return-0}function xtract_failsafe_f0(t,r){return xtract_f0(t,r)}function xtract_wavelet_f0(t,r,e){function a(t){return 0===t?1:2===t?1:1&t?0:a(t>>1)}function n(t){return 0===t?0:1===t?1:2===t?2:n(t>>1)+1}function s(t){if(a(t))return t;if(1===t)return 2;var r,e=n(t),s=1;for(r=0;r<e;r++)s<<=1;return s}function i(t){return t>=0?t:-t}function u(t){var r,e=1;for(r=0;r<t;r++)e<<=1;return e}function o(){if(v=Math.floor(44100/(3e3*u(M))),y<2)F=!1;else{var t,r=-1e3,e=0,a=0,n=-1e6,s=-1e6,o=0,h=0;if(function(){for(c=2;c<y;c++)l=d[c]-g,(m=d[c-1]-g)<=0&&l>0&&(o=1),m>=0&&l<0&&(h=1),t=l-m,r>-1e3&&(h&&r<0&&t>=0&&Math.abs(l)>=w&&c>n+v&&(b[e++]=c,n=c,h=0),o&&r>0&&t<=0&&Math.abs(l)>=w&&c>s+v&&(x[a++]=c,s=c,o=0)),r=t}(),0!==e||0!==a){var A,k=new Int32Array(_);!function(){for(c=0;c<e;c++)for(f=1;f<3;f++)c+f<e&&(A=i(b[c]-b[c+f]),k[A]=k[A]+1);for(c=0;c<a;c++)for(f=1;f<3;f++)c+f<a&&(A=i(x[c]-x[c+f]),k[A]=k[A]+1)}();var C=-1,S=-1;!function(){for(c=0;c<y;c++){var t=0;for(f=-v;f<=v;f++)c+f>=0&&c+f<y&&(t+=k[c+f]);t===S?c===2*C&&(C=c):t>S&&(S=t,C=c)}}();var P=0,N=0;if(function(){for(f=-v;f<=v;f++)if(C+f>=0&&C+f<_){var t=k[C+f];t>0&&(N+=t,P+=(C+f)*t)}}(),P/=N,D>-1){if(Math.abs(2*P-D)<=2*v)return p=44100/(u(M-1)*D),void(F=!1)}D=P,(M+=1)>=6?F=!1:y<2?F=!1:(!function(){for(c=0;c<y/2;c++)d[c]=(d[2*c]+d[2*c+1])/2}(),y/=2)}else F=!1}}if(!xtract_assert_array(t))return 0;if(void 0===e)throw"xtract_wavelet_f0 requires pitchtracker to be defined";if(0!==xtract_array_sum(t)){var c,f,l,m,h=t,_=t.length,p=0;_=function(t){return a(t)?t:s(t)/2}(_);var d=new Float64Array(_);for(c=0;c<_;c++)d[c]=h[c];for(var v,y=_,b=new Int32Array(_),x=new Int32Array(_),g=function(t,r){return xtract_mean(t.subarray(r))}(d,_),w=.75*function(t,r){var e,a,n=0,s=0;for(a=0;a<r;a++)(e=t[a])>s&&(s=e),e<n&&(n=e);return s-=g,n-=g,s>-n?s:-n}(d,_),M=0,D=-1,F=!0;F;)o();return function(t,r){if(0===r)return-1;var e=-1;return-1!==r?-1===t._prevPitch?(e=r,t._prevPitch=r,t._pitchConfidence=1):Math.abs(t._prevPitch-r)/r<.2?(t._prevPitch=r,e=r,t._pitchConfidence=Math.min(5,t._pitchConfidence+1)):t._pitchConfidence>=3&&Math.abs(t._pitchConfidence-2*r)/(2*r)<.2?(e=2*r,t._prevPitch=e):t._pitchConfidence>=3&&Math.abs(t._pitchConfidence-.5*r)/(.5*r)<.2?(e=.5*r,t._prevPitch=e):t._pitchConfidence>=1?(e=t._prevPitch,t._pitchConfidence=Math.max(0,t._pitchConfidence-1)):(e=r,t._prevPitch=r,t._pitchConfidence=1):-1!==t._prevPitch&&(t._pitchConfidence>=1?(e=t._prevPitch,t._pitchConfidence=Math.max(0,t._pitchConfidence-1)):(t._prevPitch=-1,e=-1,t._pitchConfidence=0)),-1===(r=t._pitchConfidence>=1?e:-1)&&(r=0),r}(e,p)}}function xtract_midicent(t){if("number"!=typeof t)return-1;var r=0;return r=69+17.31234*Math.log(t/440),r*=100,r=Math.round(.5+r)}function xtract_spectral_fundamental(t,r){if(!xtract_assert_array(t))return 0;var e,a=t.length>>1,n=t.subarray(0,a),s=(t.subarray(a),2*a),i=new Float64Array(s);for(e=0;e<a;e++)i[e]=Math.pow(n[e],2),i[s-1-e]=i[e];var u=new Float64Array(s);inverseTransform(i,u),u=void 0,u=i,i=void 0;var o=function(t,r){var e,a=[],n=t.length;for(void 0===r&&(r=5),e=r;e<n-r-1;e++){var s,i=1;for(s=-r;s<r-1;s++)if(t[e+s]>t[e]){i=0;break}1===i&&a.push(e)}return a}(u,5);return 0===o.length?0:(o=o[0],o/=r,o=1/o)}function xtract_energy(t,r,e){if(!xtract_assert_array(t))return 0;{if("number"==typeof r){"number"!=typeof e&&(e=100),e<=0&&(e=100);for(var a=t.length,n=Math.floor(r*(e/1e3)),s=Math.ceil(a/n),i=new Float64Array(s),u=0;u<s;u++){var o=xtract_rms_amplitude(t.subarray(u*n,u*n+n));i[u]=o}return i}console.error("xtract_energy requires sample_rate to be defined")}}function xtract_spectrum(t,r,e,a){if(function(t,e){if("number"!=typeof r)throw"Sample Rate must be defined"}(),!xtract_assert_array(t))return 0;e=!0===e,a=!0===a;var n,s,i,u=t.length,o=0;e?n=new Float64Array(u+2):(o=1,n=new Float64Array(u)),s=n.subarray(0,n.length/2),i=n.subarray(n.length/2);var c=new Float64Array(u),f=new Float64Array(u);t.forEach(function(t,r){c[r]=t}),transform(c,f);for(var l=o;l<=n.length/2;l++)s[l-o]=Math.sqrt(c[l]*c[l]+f[l]*f[l])/t.length,i[l-o]=2*l/u*(r/2);return a&&(s=xtract_array_normalise(s)),n}function xtract_complex_spectrum(t,r,e){if(!xtract_assert_array(t))return 0;if("number"!=typeof r)return console.error("Sample Rate must be defined"),null;void 0===e&&(e=!1);var a,n,s,i=t.length,u=0;e?a=new Float64Array(3*(i/2+1)):(u=1,a=new Float64Array(i/2*3)),n=a.subarray(0,a.length/3*2),s=a.subarray(a.length/3*2);for(var o=new Float64Array(i),c=new Float64Array(i),f=0;f<i;f++)o[f]=t[f];transform(o,c);for(var l=u;l<=o.length/2;l++)n[2*(l-u)]=o[l],n[2*(l-u)+1]=c[l],s[l-u]=2*l/i*(r/2);return a}function xtract_mfcc(t,r){if(!xtract_assert_array(t))return 0;var e=t.length>>1;!function(t){if("object"!=typeof t)throw"Invalid MFCC, must be MFCC object built using xtract_init_mfcc";if(0===t.n_filters)throw"Invalid MFCC, object must be built using xtract_init_mfcc";if(t.filters[0].length!==e)throw"Lengths do not match"}(r);var a=new Float64Array(r.n_filters);return a.forEach(function(e,a,n){n[a]=0;for(var s=r.filters[a],i=0;i<s.length;i++)n[a]+=t[i]*s[i];n[a]=Math.log(Math.max(n[a],2e-42))}),xtract_dct(a)}function xtract_dct(t){if(!xtract_assert_array(t))return 0;var r=t.length,e=new Float64Array(r);if(t.reduce)e.forEach(function(e,a,n){var s=a/r;n[a]=t.reduce(function(t,r,e){return t+r*Math.cos(Math.PI*s*(e+.5))})});else for(var a=0;a<r;a++)for(var n=a/r,s=0;s<r;s++)e[a]+=t[s]*Math.cos(Math.PI*n*(s+.5));return e}function xtract_dct_2(t,r){if(!xtract_assert_array(t))return 0;var e=t.length;void 0===r&&(r=xtract_init_dct(e));var a=new Float64Array(e);if(a[0]=xtract_array_sum(t),a.forEach&&t.reduce)a.forEach(function(e,a,n){n[a]=t.reduce(function(t,e,n){return t+e*r.wt[a][n]})});else for(var n=1;n<e;n++)for(var s=0;s<e;s++)a[n]+=t[s]*r.wt[n][s];return a}function xtract_autocorrelation(t){if(!xtract_assert_array(t))return 0;for(var r=t.length,e=new Float64Array(r);r--;){for(var a=0,n=0;n<t.length-r;n++)a+=t[n]*t[n+r];e[r]=a/t.length}return e}function xtract_amdf(t){if(!xtract_assert_array(t))return 0;for(var r=t.length,e=new Float64Array(r);r--;){for(var a=0,n=0;n<t.length-r;n++)a+=Math.abs(t[n]-t[n+r]);e[r]=a/t.length}return e}function xtract_asdf(t){if(!xtract_assert_array(t))return 0;for(var r=t.length,e=new Float64Array(r);r--;){for(var a=0,n=0;n<t.length-r;n++)a+=Math.pow(t[n]-t[n+r],2);e[r]=a/t.length}return e}function xtract_bark_coefficients(t,r){if(!xtract_assert_array(t))return 0;if(void 0===r)throw"xtract_bark_coefficients requires compute limits from xtract_init_bark";t.length;for(var e=r.length,a=new Float64Array(e),n=0;n<e-1;n++){a[n]=0;for(var s=r[n];s<r[n+1];s++)a[n]+=t[s]}return a}function xtract_peak_spectrum(t,r,e){if(!xtract_assert_array(t))return 0;var a=t.length,n=a>>1,s=0,i=0,u=0,o=0;if("number"!=typeof r)throw"xtract_peak_spectrum requires second argument to be sample_rate/N";(e<0||e>100)&&(e=0);var c=new Float64Array(a),f=t.subarray(0,n),l=(t.subarray(n),c.subarray(0,n)),m=c.subarray(n);e*=.01*xtract_array_max(f);for(var h=1;h<a-1;h++)f[h]>=e&&f[h]>f[h-1]&&f[h]>f[h+1]?(s=f[h-1],i=f[h],o=.5*(s-(u=f[h+1]))/(f[h-1]-2*(i+f[h+1])),m[h]=r*(h+1+o),l[h]=i-.25*(s-u)*o):(l[h]=0,m[h]=0);return c}function xtract_harmonic_spectrum(t,r,e){if(!xtract_assert_array(t))return 0;var a=t.length,n=a>>1,s=new Float64Array(a),i=t.subarray(0,n),u=t.subarray(n),o=s.subarray(0,n),c=s.subarray(n),f=n;if(void 0===r||void 0===e)throw"harmonic_spectrum requires f0 and threshold to be numbers and defined";for(e>1&&(e/=100);f--;)if(0!==u[f]){var l=u[f]/r,m=Math.round(l);Math.abs(m-l)>e?(o[f]=0,c[f]=0):(o[f]=i[f],c[f]=u[f])}else s[f]=0,c[f]=0;return s}function xtract_lpc(t){if(!xtract_assert_array(t))return 0;var r,e,a,n=t[0],s=t.length-1,i=new Float64Array(s),u=new Float64Array(s);return 0===n?i:(function(){for(r=0;r<s;r++){for(a=-t[r+1],e=0;e<r;e++)a-=i[e]*t[r-e];for(a/=n,u[r]=a,i[r]=a,e=0;e<r>>1;e++){var o=i[e];i[e]+=a*i[r-1-e],i[r-1-e]+=a*o}r%2&&(i[e]+=i[e]*a),n*=1-a*a}}(),i)}function xtract_lpcc(t,r){if(!xtract_assert_array(t))return 0;var e,a,n,s,i=t.length,u=i-1;"number"!=typeof r&&(r=i-1),s=r;var o=new Float64Array(s);return function(){for(e=1;e<r&&e<s;e++){for(n=0,a=1;a<e;a++)n+=a*o[a-1]*t[e-a];o[e-1]=t[e]+n/e}}(),function(){for(e=u+1;e<=s;e++){for(n=0,a=e-(u-1);a<e;a++)n+=a*o[a-1]*t[e-a];o[e-1]=n/e}}(),o}function xtract_pcp(t,r,e){if(!xtract_assert_array(t))return 0;var a=t.length>>1;if("object"!=typeof r){if("number"!=typeof e||e<=0)throw"Cannot dynamically compute M if fs is undefined / not a valid sample rate";r=xtract_init_pcp(a,e)}for(var n=t.subarray(1,a),s=new Float64Array(12),i=0;i<n.length;i++){r[i];s[i]+=Math.pow(Math.abs(n[i]),2)}return s}function xtract_yin(t){if(!xtract_assert_array(t))return 0;for(var r=t.length,e=new Float64Array(t.length),a=new t.constructor(t.length),n=0,s=1;s<r;s++){for(var i=0,u=1;u<r-s;u++)i+=Math.pow(t[u]-t[u+s],2);e[s]=i,n+=i,a[s]=e[s]/(1/s*n)}return a}function xtract_onset(t,r){function e(t,r){return void 0===r&&2===t.length?Math.atan2(t[1],t[0]):Math.atan2(r,t)}function a(t,r){return void 0===r&&2===t.length?Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)):Math.sqrt(Math.pow(t,2)+Math.pow(r,2))}function n(t){return(t+Math.PI)%(-2*Math.PI)+Math.PI}function s(t,r){if(2!==t.length||2!==r.length)throw"Both arguments must be numeral arrays of length 2";var e=new t.constructor(2);return e[0]=t[0]*r[0]-t[1]*r[1],e[1]=t[0]*r[1]+t[1]*r[0],e}if(!xtract_assert_array(t))return 0;if(void 0===r)throw"All arguments for xtract_onset must be defined: xtract_onset(timeData, frameSize)";for(var i,u=xtract_get_data_frames(t,r,r,!1),o=u.length,c=r/2+1,f=function(t,r){for(var e,a=t.length,n=[],s=new Float64Array(r),i=new Float64Array(r),u=r/2+1,o=0;o<a;o++){for(e=0;e<r;e++)s[e]=t[o][e],i[e]=0;transform(s,i),n[o]=xtract_array_interlace([s.subarray(0,u),i.subarray(0,u)])}return n}(u,r),l=new t.constructor(o),m=0;m<c;m++){var h=e(f[0].subarray(2*m,2*m+2)),_=e(f[0].subarray(2*m,2*m+2));for(i=1;i<o;i++){var p=n(h+_),d=[Math.cos(p),Math.sin(p)],v=s(f[i].subarray(2*m,2*m+2),d);v[0]=f[i][2*m]-v[0],v[1]=f[i][2*m+1]-v[1],l[i]+=a(v);var y=e(f[i].subarray(2*m,2*m+2));_=y-h,h=y}}for(i=0;i<o;i++)l[i]/=r;return l}function xtract_resample(t,r,e,a){function n(t,r){var e,a,n;e=Math.floor(r*t),a=new Float64Array(t),n=new Float64Array(t);var s,i;for(s=0;s<e;s++)a[s]=1;for(s=t-e+1;s<t;s++)a[s]=1;for(inverseTransform(a,n),s=0;s<t;s++){i=(s+(t>>1))%t,n[s]=a[i]/t;var u=Math.PI*s/t;n[s]*=.35875-.48829*Math.cos(2*u)+.14128*Math.cos(4*u)-.01168*Math.cos(6*u)}return n}function s(t,r){var e,a=t.length,n=[0,t[0],t[1]],s=new Float64Array(r),i=1/(r/a),u=0,o=0;for(e=0;e<r;e++){if(o===u)s[e]=t[u];else{var c=(o-u-1)*(o-u)*n[0]-2*(o-u-1)*(o-u+1)*n[1]+(o-u)*(o-u+1)*n[2];s[e]=c/2}(o+=i)>=u+1&&(u=Math.floor(o),n[0]=t[u-1],n[1]=t[u],n[2]=u+1<a?t[u+1]:0)}return s}function i(t){var r=function(t){for(var r=new Float64Array(2*t.length),e=0;e<t.length;e++)r[e]=t[e];return r}(t),e=new Float64Array(r.length);return transform(r,e),{real:r,imag:e}}function u(t,r){var e,a,n=new Float64Array(t.length),s=r.length,u=2*s,o=i(r),c=xtract_get_data_frames(t,s,s,!1),f=xtract_get_data_frames(n,s,s,!1),l=new Float64Array(s),m=new Float64Array(s),h=function(t){var r,e=new Float64Array(t);for(r=0;r<t;r++){var a=Math.PI*r/t;e[r]=.35875-.48829*Math.cos(2*a)+.14128*Math.cos(4*a)-.01168*Math.cos(6*a)}return e}(u),_={real:new Float64Array(u),imag:new Float64Array(u)},p={real:new Float64Array(u),imag:new Float64Array(u)};for(a=0;a<c.length;a++){for(e=0;e<s;e++)_.real[e]=l[e]*h[e],_.real[e+s]=c[a][e]*h[e+s],l[e]=c[a][e],_.imag[e]=0,_.imag[e+s]=0;for(transform(_.real,_.imag),e=0;e<u;e++)p.real[e]=_.real[e]*o.real[e]-_.imag[e]*o.imag[e],p.imag[e]=_.imag[e]*o.real[e]+_.real[e]*o.imag[e];for(transform(p.imag,p.real),e=0;e<s;e++){var d=p.real[e+s]/s;p.real[e+s]=p.real[e]/s,p.real[e]=d}for(e=0;e<s;e++)f[a][e]=p.real[e]+m[e],m[e]=p.real[e+s]}return n}if(!xtract_assert_array(t))return 0;var o=t.length;if(("number"!=typeof a||a<=0)&&(a=512),r===e)return t;var c,f=r/e,l=Math.floor(o*f);if(r>e)c=s(t,l),u(t,n(a,1/f));else{c=s(u(t,n(a,f/2)),l)}return c}function xtract_init_dft(t){for(var r={N:t/2+1,real:[],imag:[]},e=-2*Math.PI/t,a=0;a<r.N;a++){var n=e*a;r.real[a]=new Float64Array(t),r.imag[a]=new Float64Array(t);for(var s=0;s<t;s++){var i=n*s;r.real[a][s]=Math.cos(i),r.imag[a][s]=Math.sin(i)}}return r}function xtract_init_dct(t){for(var r={N:t,wt:[]},e=0;e<t;e++){r.wt[e]=new Float64Array(t);for(var a=0;a<t;a++)r.wt[e][a]=Math.cos(Math.PI*e*(a+.5)/t)}return r}function xtract_init_mfcc(t,r,e,a,n,s){var i,u={n_filters:s,filters:[]};if(s<=1)return null;var o,c,f=0,l=function(r,e,a,n,s){var i,u,o,c=t/2,f=1127*Math.log(1+r/700),l=1127*Math.log(1+e/700),m=(f-l)/a,h=new Float64Array(a+2),_=new Float64Array(a+2),p=new Float64Array(a+2),d=new Float64Array(a);for(h[0]=l,_[0]=e,p[0]=Math.floor(_[0]/n*c),o=1;o<a+2;++o)h[o]=h[o-1]+m,_[o]=700*(Math.exp(h[o]/1127)-1),p[o]=Math.floor(_[o]/n*c);for(o=0;o<a;o++)"XTRACT_EQUAL_GAIN"===s?(i=1,u=1):(i=2/(_[o+2]-_[o]),u=1/(2/(_[2]-_[0]))),d[o]=i*u;return{f:p,h:d}}(n,a,s,r,e),m=l.f,h=l.h;for(i=0;i<s;i++){o=0===i?h[i]/m[i]:h[i]/(m[i]-m[i-1]);var _=0;for(u.filters[i]=new Float64Array(t);f<=m[i];f++)u.filters[i][f]=_,_+=o;for(o=h[i]/(m[i+1]-m[i]),_=0,c=m[i+1],f=Math.floor(c);f>m[i];f--)u.filters[i][f]=_,_+=o}return u}function xtract_init_wavelet(){return{_prevPitch:-1,_pitchConfidence:-1}}function xtract_init_pcp(t,r,e){!function(t,r){if("number"!=typeof r||"number"!=typeof t)throw"The Sample Rate and sample count have to be defined: xtract_init_pcp(N, fs, f_ref)";if(t<=0||t!==Math.floor(t))throw"The sample count, N, must be a positive integer: xtract_init_pcp(N, fs, f_ref)";if(r<=0)throw"The Sample Rate must be a positive number: xtract_init_pcp(N, fs, f_ref)"}(t,r),("number"!=typeof e||e<=0||e>=r/2)&&(e=48.9994294977);for(var a=new Float64Array(t-1),n=r/2,s=1;s<t;s++){var i=2*s/t*n;a[s-1]=Math.round(12*Math.log2(i/t*e))%12}return a}function xtract_init_bark(t,r,e){("number"!=typeof e||e<0||e>26)&&(e=26);for(var a=[0,100,200,300,400,510,630,770,920,1080,1270,1480,1720,2e3,2320,2700,3150,3700,4400,5300,6400,7700,9500,12e3,15500,20500,27e3],n=new Int32Array(e);e--;)n[e]=a[e]/r*t;return n}function xtract_init_chroma(t,r,e,a,n,s){("number"!=typeof e||e<=1)&&(e=12),("number"!=typeof a||a<=27.5)&&(a=440),"number"!=typeof n&&(n=1e3),"number"!=typeof s&&(s=1);var i,u,o=t,c=Math.log(n/27.5)/Math.LN2,f={wts:[],nfft:o,nbins:e},l=new Float64Array(o),m=new Float64Array(o),h=function(t){return Math.log(t/(a/16))/Math.LN2};for(i=1;i<o;i++)l[i]=e*h(i/t*r);for(l[0]=l[1]-1.5*e,i=0;i<o-1;i++){var _=l[i+1]-l[i];m[i]=_>=1?_:1}m[o-1]=1;var p=Math.round(e/2),d=[];for(i=0;i<e;i++)for(d[i]=[],u=0;u<o;u++){var v=l[u]-i,y=m[u],b=(v+p+10*e)%e-p;d[i][u]=Math.exp(-.5*Math.pow(2*b/y,2))}var x=xtract_array_sum,g=function(t){if(void 0===t)return[];var r,e,a=t.length,n=t[0].length,s=[];for(r=0;r<n;r++)s[r]=new Float64Array(a);for(r=0;r<a;r++)for(e=0;e<n;e++)s[e][r]=t[r][e];return s}(d).map(x);for(i=0;i<e;i++)for(u=0;u<o;u++)d[i][u]*=1/g[u];if(s>0)for(i=0;i<e;i++)for(u=0;u<o;u++)d[i][u]*=Math.exp(-.5*Math.pow((l[u]/e-c)/s,2));return f.wts=d,f}function xtract_apply_window(t,r){!function(t,r){if(!xtract_assert_array(t)||!xtract_assert_array(r))throw"Both X and W must be defined";if(t.length!==r.length)throw"Both X and W must be the same lengths"}(t,r);var e,a=t.length,n=new Float64Array(a);for(e=0;e<a;e++)n[e]=t[e]*r[e];return n}function xtract_create_window(t,r){switch(function(r,e){if(!xtract_assert_positive_integer(t))throw"N must be a defined, positive integer";if("string"!=typeof e||0===e.length)throw"Type must be defined"}(0,r),r=r.toLowerCase()){case"hamming":return function(t){var r,e=new Float64Array(t);for(r=0;r<t;r++)e[r]=25/46-21/46*Math.cos(2*Math.PI*r/(t-1));return e}(t);case"welch":return function(t){var r,e=new Float64Array(t),a=(t-1)/2;for(r=0;r<t;r++)e[r]=1-Math.pow((r-a)/a,2);return e}(t);case"sine":return function(t){var r,e=new Float64Array(t),a=Math.PI*r/(t-1);for(r=0;r<t;r++)e[r]=Math.sin(a);return e}(t);case"hann":return function(t){var r,e=new Float64Array(t);for(r=0;r<t;r++)e[r]=.5-(1-Math.cos(2*Math.PI*r/(t-1)));return e}(t);default:throw'Window function"'+r+'" not defined'}}function xtract_chroma(t,r){if(!xtract_assert_array(t))return 0;if(void 0===r.wts)throw"xtract_chroma requires chroma filters from xtract_init_chroma";if(r.nfft!==t.length/2)throw"the FFT lengths of the spectrum ("+t.length/2+") and chroma filterbank ("+r.nfft+") do not match";for(var e=new Float64Array(r.nbins),a=0;a<r.nbins;a++){for(var n=0,s=0;s<r.nfft;s++)n+=r.wts[a][s]*t[s];e[a]=n}return e}function transform(t,r){if(t.length!==r.length)throw"Mismatched lengths";var e=t.length;0!==e&&(0==(e&e-1)?transformRadix2(t,r):transformBluestein(t,r))}function inverseTransform(t,r){transform(r,t)}function transformRadix2(t,r){function e(t,r){for(var e=0,a=0;a<r;a++)e=e<<1|1&t,t>>>=1;return e}if(t.length!==r.length)throw"Mismatched lengths";var a=t.length;if(1!==a){var n=function(t){var r;for(r=0;r<32;r++)if(1<<r===t)return r;return-1}(a);if(-1===n)throw"Length is not a power of 2";var s=new Float64Array(a/2),i=new Float64Array(a/2);!function(t,r){var e,a=t.length;for(e=0;e<a;e++)t[e]=Math.cos(Math.PI*e/a),r[e]=Math.sin(Math.PI*e/a)}(s,i),function(t,r){var s,i,u;for(s=0;s<a;s++)(i=e(s,n))>s&&(u=t[s],t[s]=t[i],t[i]=u,u=r[s],r[s]=r[i],r[i]=u)}(t,r);for(var u=2;u<=a;u*=2)!function(t,r,e,a,n){var s,i,u,o=t.length,c=n/2,f=o/n;for(s=0;s<o;s+=n)for(i=s,u=0;i<s+c;i++,u+=f){var l=t[i+c]*a[u]+r[i+c]*e[u],m=-t[i+c]*e[u]+r[i+c]*a[u];t[i+c]=t[i]-l,r[i+c]=r[i]-m,t[i]+=l,r[i]+=m}}(t,r,i,s,u)}}function transformBluestein(t,r){if(t.length!==r.length)throw"Mismatched lengths";for(var e,a,n=t.length,s=1;s<2*n+1;)s*=2;var i=new Float64Array(n),u=new Float64Array(n);!function(t,r){for(e=0;e<n;e++)a=e*e%(2*n),t[e]=Math.cos(Math.PI*a/n),r[e]=Math.sin(Math.PI*a/n)}(i,u);var o=new Float64Array(s),c=new Float64Array(s);for(e=0;e<n;e++)o[e]=t[e]*i[e]+r[e]*u[e],c[e]=-t[e]*u[e]+r[e]*i[e];var f=new Float64Array(s),l=new Float64Array(s);for(f[0]=i[0],l[0]=u[0],e=1;e<n;e++)f[e]=f[s-e]=i[e],l[e]=l[s-e]=u[e];var m=new Float64Array(s),h=new Float64Array(s);for(convolveComplex(o,c,f,l,m,h),e=0;e<n;e++)t[e]=m[e]*i[e]+h[e]*u[e],r[e]=-m[e]*u[e]+h[e]*i[e]}function convolveReal(t,r,e){if(t.length!==r.length||t.length!==e.length)throw"Mismatched lengths";for(var a=new Array(t.length),n=0;n<a.length;n++)a[n]=0;convolveComplex(t,a,r,a.slice(),e,a.slice())}function convolveComplex(t,r,e,a,n,s){!function(){if(t.length!==r.length||t.length!==e.length||e.length!==a.length||t.length!==n.length||n.length!==s.length)throw"Mismatched lengths"}();var i,u=t.length;for(t=t.slice(),r=r.slice(),e=e.slice(),a=a.slice(),transform(t,r),transform(e,a),i=0;i<u;i++){var o=t[i]*e[i]-r[i]*a[i];r[i]=r[i]*e[i]+t[i]*a[i],t[i]=o}for(inverseTransform(t,r),i=0;i<u;i++)n[i]=t[i]/u,s[i]=r[i]/u}var jsXtract=function(){function t(t,r){return t.find(function(t){for(var e in r)if(t[e]!==r[e])return!1;return!0})}var r={parent:this,store:[],createCoefficients:function(r){var e=t(this.store,{N:r});return e||(e={N:r,data:xtract_init_dct(r)},this.store.push(e)),e.data}},e={parent:this,store:[],createCoefficients:function(r,e,a,n,s,i){var u={N:r,nyquist:e,style:a,freq_min:n,freq_max:s,freq_bands:i},o=t(this.store,u);return o||((o=u).data=xtract_init_mfcc(r,e,a,n,s,i),this.store.push(o)),o.data}},a={parent:this,store:[],createCoefficients:function(r,e,a){var n={N:r,sampleRate:e,numBands:a},s=t(this.store,n);return s||((s=n).data=xtract_init_bark(r,e,a),this.store.push(s)),s.data}},n={parent:this,store:[],createCoefficients:function(r,e,a,n,s,i){var u={N:r,sampleRate:e,nbins:a,A440:n,f_ctr:s,octwidth:i},o=t(this.store,u);return o||((o=u).data=xtract_init_chroma(r,e,a,n,s,i),this.store.push(o)),o.data}},s={};return Object.defineProperties(s,{createDctCoefficients:{value:function(t){return r.createCoefficients(t)}},createMfccCoefficients:{value:function(t,r,a,n,s,i){return e.createCoefficients(t,r,a,n,s,i)}},createBarkCoefficients:{value:function(t,r,e){return("number"!=typeof e||e<0||e>26)&&(e=26),a.createCoefficients(t,r,e)}},createChromaCoefficients:{value:function(t,r,e,a,s,i){return n.createCoefficients(t,r,e,a,s,i)}}}),s}(),DataProto=function(t,r){function e(t,r){var a,n={};for(a in t)r[a]&&("number"==typeof t[a]?n[a]=t[a]-r[a]:n[a]=function(t,r,a){{if(t.result&&r.result)return e(t[a].result,r[a].result);if(t.length&&r.length)return function(t,r){var e;e=t.length===r.length?new Float64Array(t.length):[];var a=0;for(;a<t.length&&a<r.length;)e[a]=t[a]-r[a],a++;return e}(t[a],r[a])}return}(t,r,a));return n}var a={},n=new Float64Array(t);this.clearResult=function(){a={}},Object.defineProperties(this,{result:{get:function(){return a},set:function(){}},data:{value:n},getData:{value:function(){return n}}}),this.zeroDataRange=function(t,r){if(n.fill)n.fill(0,t,r);else for(var e=t;e<r;e++)n[e]=0;this.clearResult()},this.copyDataFrom=function(t,r,e){if("object"!=typeof t||void 0===t.length)throw"copyDataFrom requires src to be an Array or TypedArray";void 0===e&&(e=0),void 0===r&&(r=Math.min(t.length,n.length)),r=Math.min(r+e,n.length);for(var a=0;a<r;a++)n[a+e]=t[a];this.clearResult()},this.duplicate=function(){this.prototype.constructor(t,r).copyDataFrom(n)},this.toJSON=function(){function t(t){var r=t[t.length-1];return"{"!==r&&","!==r&&(t+=", "),t}function r(t,r){return"number"==typeof t&&isFinite(t)?'"'+r+'": '+t:"object"==typeof t?t.toJSON?'"'+r+'": '+t.toJSON(t):t.length?'"'+r+'": '+xtract_array_to_JSON(t):'"'+r+'": '+this.toJSON(t):'"'+r+'": "'+t.toString()+'"'}var e="{";for(var n in a)a.hasOwnProperty(n)&&(e=t(e),e+=r(a[n],n));return e+"}"},this.computeDelta=function(t){return this.result.delta=e(this.result,t.result),this.result.delta},this.computeDeltaDelta=function(t){if(!t.result.delta||!this.result.delta)throw"Cannot compute delta-delta without both objects having deltas";return this.result.delta.delta=e(this.result.delta,t.result.delta),this.result.delta.delta}};DataProto.prototype.createDctCoefficients=function(t){return jsXtract.createDctCoefficients(Number(t))},DataProto.prototype.createMfccCoefficients=function(t,r,e,a,n,s){return t=Number(t),r=Number(r),a=Number(a),n=Number(n),s=Number(s),jsXtract.createMfccCoefficients(t,r,e,a,n,s)},DataProto.prototype.createBarkCoefficients=function(t,r,e){return t=Number(t),r=Number(r),e=Number(e),jsXtract.createBarkCoefficients(t,r,e)},DataProto.prototype.createChromaCoefficients=function(t,r,e,a,n,s){return t=Number(t),r=Number(r),e=Number(e),a=Number(a),n=Number(n),s=Number(s),jsXtract.createChromaCoefficients(t,r,e,a,n,s)};var TimeData=function(t,r,e){r<=0&&(r=void 0,console.log("Invalid parameter for 'sampleRate' for TimeData"));var a,n,s,i;if("object"==typeof t){var u;if(t.constructor===TimeData)u=u.getData(),a=u.length,DataProto.call(this,a),t=a,this.copyDataFrom(u,t,0);else{if(t.constructor!==Float32Array&&t.constructor!==Float64Array)throw"TimeData: Invalid object passed as first argument.";t=a=(u=t).length,DataProto.call(this,a),this.copyDataFrom(u,t,0)}}else{if("number"!=typeof t)throw"TimeData: Constructor has invalid operators!";if(t<=0||t!==Math.floor(t))throw"TimeData: Invalid number passed as first argument.";a=t,DataProto.call(this,t,r)}n=r,i=void 0,s=xtract_init_wavelet(),this.zeroData=function(){this.zeroDataRange(0,t)},Object.defineProperties(this,{features:{values:this.constructor.prototype.features},sampleRate:{get:function(){return n},set:function(t){if(void 0!==n)throw"Cannot set one-time variable";n=t}},length:{value:a,writable:!1,enumerable:!0},getFrames:{value:function(t,r){if("number"!=typeof t||t<=0||t!==Math.floor(t))throw"frameSize must be a defined, positive integer";"number"!=typeof r&&(r=t);for(var e=Math.ceil(a/t),s=[],i=0;i<e;i++){var u=new TimeData(r,n);u.copyDataFrom(this.data.subarray(t*i,t*i+r)),s.push(u)}return s}},minimum:{value:function(){return void 0===this.result.minimum&&(this.result.minimum=xtract_array_min(this.data)),this.result.minimum}},maximum:{value:function(){return void 0===this.result.maximum&&(this.result.maximum=xtract_array_max(this.data)),this.result.maximum}},sum:{value:function(){return void 0===this.result.sum&&(this.result.sum=xtract_array_sum(this.data)),this.result.sum}},mean:{value:function(){return void 0===this.result.mean&&(this.result.mean=xtract_mean(this.data)),this.result.mean}},temporal_centroid:{value:function(t){return void 0===this.result.temporal_centroid&&(this.energy(t),this.result.temporal_centroid=xtract_temporal_centroid(this.result.energy.data,n,t)),this.result.temporal_centroid}},variance:{value:function(){return void 0===this.result.variance&&(this.result.variance=xtract_variance(this.data,this.mean())),this.result.variance}},standard_deviation:{value:function(){return void 0===this.result.standard_deviation&&(this.result.standard_deviation=xtract_standard_deviation(this.data,this.variance())),this.result.standard_deviation}},average_deviation:{value:function(){return void 0===this.result.average_deviation&&(this.result.average_deviation=xtract_average_deviation(this.data,this.mean())),this.result.average_deviation}},skewness:{value:function(){return void 0===this.result.skewness&&(this.result.skewness=xtract_skewness(this.data,this.mean(),this.standard_deviation())),this.result.skewness}},kurtosis:{value:function(){return void 0===this.result.kurtosis&&(this.result.kurtosis=xtract_kurtosis(this.data,this.mean(),this.standard_deviation())),this.result.kurtosis}},zcr:{value:function(){return void 0===this.result.zcr&&(this.result.zcr=xtract_zcr(this.data)),this.result.zcr}},crest_factor:{value:function(){return void 0===this.result.crest_factor&&(this.result.crest_factor=xtract_crest(this.data,this.maximum(),this.mean())),this.result.crest_factor}},rms_amplitude:{value:function(){return void 0===this.result.rms_amplitude&&(this.result.rms_amplitude=xtract_rms_amplitude(this.data)),this.result.rms_amplitude}},lowest_value:{value:function(t){return void 0===this.result.lowest_value&&(this.result.lowest_value=xtract_lowest_value(this.data,t)),this.result.lowest_value}},highest_value:{value:function(t){return void 0===this.result.highest_value&&(this.result.highest_value=xtract_highest_value(this.data,t)),this.result.highest_value}},nonzero_count:{value:function(){return void 0===this.result.nonzero_count&&(this.result.nonzero_count=xtract_nonzero_count(this.data)),this.result.nonzero_count}},f0:{value:function(){return void 0===s&&(s=this.init_wavelet()),void 0===this.result.f0&&(this.result.f0=xtract_wavelet_f0(this.data,n,s)),this.result.f0}},energy:{value:function(t){return void 0!==this.result.energy&&this.result.energy.window_ms===t||(this.result.energy={data:xtract_energy(this.data,n,t),window_ms:t}),this.result.energy}},spectrum:{value:function(){if(void 0===this.result.spectrum){var t=xtract_spectrum(this.data,n,!0,!1);return this.result.spectrum=new SpectrumData(t.length/2,n),this.result.spectrum.copyDataFrom(t),this.result.spectrum}}},dct:{value:function(){return void 0===i&&(i=this.createDctCoefficients(a)),void 0===this.result.dct&&(this.result.dct=xtract_dct_2(this.data,i)),this.result.dct}},autocorrelation:{value:function(){return void 0===this.result.autocorrelation&&(this.result.autocorrelation=xtract_autocorrelation(this.data)),this.result.autocorrelation}},amdf:{value:function(){return void 0===this.result.amdf&&(this.result.amdf=xtract_amdf(this.data)),this.result.amdf}},asdf:{value:function(){return void 0===this.result.asdf&&(this.result.asdf=xtract_asdf(this.data)),this.result.asdf}},yin:{value:function(){return void 0===this.result.yin&&(this.result.yin=xtract_yin(this.data)),this.result.yin}},onset:{value:function(t){return void 0!==this.result.onset&&this.result.onset.frameSize===t||(this.result.onset={data:xtract_onset(this.data,t),frameSize:t}),this.result.onset}},resample:{value:function(t){if(void 0===n)throw"Source sampleRate must be defined";if("number"!=typeof t||t<=0)throw"Target sampleRate must be a positive number";var r=xtract_resample(this.data,t,n),e=new TimeData(r.length,t);return e.copyDataFrom(r),this.result.resample=e,e}}})};TimeData.prototype=Object.create(DataProto.prototype),TimeData.prototype.constructor=TimeData;var SpectrumData=function(t,r,e){function a(){for(var r=0;r<t;r++)f[r]=r/t*(m/2)}if(void 0===t||t<=0)throw"SpectrumData constructor requires N to be a defined, whole number";void 0===r&&(r=Math.PI),DataProto.call(this,2*t,r);var n,s,i,u,o,c=this.data.subarray(0,t),f=this.data.subarray(t,2*t),l=t,m=r;a(),this.zeroData=function(){this.zeroDataRange(0,t)},Object.defineProperties(this,{features:{get:function(){return this.constructor.prototype.features},set:function(){}},sampleRate:{get:function(){return m},set:function(r){if(m!==Math.PI)throw"Cannot set one-time variable";m=r,a(),i=xtract_init_bark(t,m)}},f0:{get:function(){return n},set:function(t){return"number"==typeof t&&(n=t),n}},init_mfcc:{value:function(t,r,e,a){return s=this.createMfccCoefficients(l,.5*m,a,r,e,t),this.result.mfcc=void 0,s}},init_bark:{value:function(t){return("number"!=typeof t||t<0||t>26)&&(t=26),i=this.createBarkCoefficients(l,m,t)}},init_chroma:{value:function(t,r,e,a){return("number"!=typeof t||t<=1)&&(t=12),("number"!=typeof r||r<=27.5)&&(r=440),"number"!=typeof e&&(e=1e3),"number"!=typeof a&&(a=1),o=this.createChromaCoefficients(l,m,t,r,e,a),this.result.chroma=void 0,o}},length:{value:l,writable:!1,enumerable:!0},minimum:{value:function(){return void 0===this.result.minimum&&(this.result.minimum=xtract_array_min(c)),this.result.minimum}},maximum:{value:function(){return void 0===this.result.maximum&&(this.result.maximum=xtract_array_max(c)),this.result.maximum}},sum:{value:function(){return void 0===this.result.sum&&(this.result.sum=xtract_array_sum(c)),this.result.sum}},spectral_centroid:{value:function(){return void 0===this.result.spectral_centroid&&(this.result.spectral_centroid=xtract_spectral_centroid(this.data)),this.result.spectral_centroid}},spectral_mean:{value:function(){return void 0===this.result.spectral_mean&&(this.result.spectral_mean=xtract_spectral_mean(this.data)),this.result.spectral_mean}},spectral_variance:{value:function(){return void 0===this.result.spectral_variance&&(this.result.spectral_variance=xtract_spectral_variance(this.data,this.spectral_centroid())),this.result.spectral_variance}},spectral_spread:{value:function(){return void 0===this.result.spectral_spread&&(this.result.spectral_spread=xtract_spectral_spread(this.data,this.spectral_centroid())),this.result.spectral_spread}},spectral_standard_deviation:{value:function(){return void 0===this.result.spectral_standard_deviation&&(this.result.spectral_standard_deviation=xtract_spectral_standard_deviation(this.data,this.spectral_variance())),this.result.spectral_standard_deviation}},spectral_skewness:{value:function(){return void 0===this.result.spectral_skewness&&(this.result.spectral_skewness=xtract_spectral_skewness(this.data,this.spectral_centroid(),this.spectral_standard_deviation())),this.result.spectral_skewness}},spectral_kurtosis:{value:function(){return void 0===this.result.spectral_kurtosis&&(this.result.spectral_kurtosis=xtract_spectral_kurtosis(this.data,this.spectral_centroid(),this.spectral_standard_deviation())),this.result.spectral_kurtosis}},irregularity_k:{value:function(){return void 0===this.result.irregularity_k&&(this.result.irregularity_k=xtract_irregularity_k(this.data)),this.result.irregularity_k}},irregularity_j:{value:function(){return void 0===this.result.irregularity_j&&(this.result.irregularity_j=xtract_irregularity_j(this.data)),this.result.irregularity_j}},tristimulus_1:{value:function(){return void 0===n&&this.spectral_fundamental(),void 0===this.result.tristimulus_1&&(this.result.tristimulus_1=xtract_tristimulus_1(this.data,n)),this.result.tristimulus_1}},tristimulus_2:{value:function(){return void 0===n&&this.spectral_fundamental(),void 0===this.result.tristimulus_2&&(this.result.tristimulus_2=xtract_tristimulus_2(this.data,n)),this.result.tristimulus_2}},tristimulus_3:{value:function(){return void 0===n&&this.spectral_fundamental(),void 0===this.result.tristimulus_3&&(this.result.tristimulus_3=xtract_tristimulus_3(this.data,n)),this.result.tristimulus_3}},smoothness:{value:function(){return void 0===this.result.smoothness&&(this.result.smoothness=xtract_smoothness(this.data)),this.result.smoothness}},rolloff:{value:function(t){return void 0===this.result.rolloff&&(this.result.rolloff=xtract_rolloff(this.data,m,t)),this.result.rolloff}},loudness:{value:function(){return void 0===this.result.loudness&&(this.result.loudness=xtract_loudness(this.bark_coefficients())),this.result.loudness}},sharpness:{value:function(){return void 0===this.result.sharpness&&(this.result.sharpness=xtract_sharpness(this.bark_coefficients())),this.result.sharpness}},flatness:{value:function(){return void 0===this.result.flatness&&(this.result.flatness=xtract_flatness(this.data)),this.result.flatness}},flatness_db:{value:function(){return void 0===this.result.flatness_db&&(this.result.flatness_db=xtract_flatness_db(this.data,this.flatness())),this.result.flatness_db}},tonality:{value:function(){return void 0===this.result.tonality&&(this.result.tonality=xtract_tonality(this.data,this.flatness_db())),this.result.tonality}},spectral_crest_factor:{value:function(){return void 0===this.result.spectral_crest_factor&&(this.result.spectral_crest_factor=xtract_crest(c,this.maximum(),this.spectral_mean())),this.result.spectral_crest_factor}},spectral_slope:{value:function(){return void 0===this.result.spectral_slope&&(this.result.spectral_slope=xtract_spectral_slope(this.data)),this.result.spectral_slope}},spectral_fundamental:{value:function(){return void 0===this.result.spectral_fundamental&&(this.result.spectral_fundamental=xtract_spectral_fundamental(this.data,m),this.f0=this.result.spectral_fundamental),this.result.spectral_fundamental}},nonzero_count:{value:function(){return void 0===this.result.nonzero_count&&(this.result.nonzero_count=xtract_nonzero_count(c)),this.result.nonzero_count}},hps:{value:function(){return void 0===this.result.hps&&(this.result.hps=xtract_hps(this.data)),this.result.hps}},mfcc:{value:function(t,r,e){if(void 0===s){if(void 0===r)throw"Run init_mfcc(num_bands, freq_min, freq_max, style) first";s=this.init_mfcc(t,r,e)}return void 0===this.result.mfcc&&(this.result.mfcc=xtract_mfcc(this.data,s)),this.result.mfcc}},dct:{value:function(){return void 0===u&&(u=this.createDctCoefficients(l)),void 0===this.result.dct&&(this.result.dct=xtract_dct_2(c,u)),this.result.dct}},bark_coefficients:{value:function(t){return void 0===this.result.bark_coefficients&&(void 0===i&&(i=this.init_bark(t)),this.result.bark_coefficients=xtract_bark_coefficients(this.data,i)),this.result.bark_coefficients}},chroma:{value:function(t,r,e,a){return void 0===this.result.chroma&&(void 0===o&&(o=this.init_chroma(t,r,e,a)),this.result.chroma=xtract_chroma(this.data,o)),this.result.chroma}},peak_spectrum:{value:function(t){if(void 0===this.result.peak_spectrum){this.result.peak_spectrum=new PeakSpectrumData(l,m,this);var r=xtract_peak_spectrum(this.data,m/l,t);this.result.peak_spectrum.copyDataFrom(r.subarray(0,l))}return this.result.peak_spectrum}}})};SpectrumData.prototype=Object.create(DataProto.prototype),SpectrumData.prototype.constructor=SpectrumData;var PeakSpectrumData=function(t,r,e){if(void 0===t||t<=0)throw"SpectrumData constructor requires N to be a defined, whole number";void 0===r&&(r=Math.PI),SpectrumData.call(this,t),Object.defineProperties(this,{spectral_inharmonicity:{value:function(){return void 0===this.result.spectral_inharmonicity&&(this.result.spectral_inharmonicity=xtract_spectral_inharmonicity(this.data,this.sampleRate)),this.result.spectral_inharmonicity}},harmonic_spectrum:{value:function(t){if(void 0===this.result.harmonic_spectrum){void 0===this.f0&&this.spectral_fundamental(this.data,this.sampleRate),this.result.harmonic_spectrum=new HarmonicSpectrumData(this.length,this.sampleRate,this);var r=xtract_harmonic_spectrum(this.data,this.f0,t);this.result.harmonic_spectrum.copyDataFrom(r.subarray(0,this.length))}return this.result.harmonic_spectrum}}})};PeakSpectrumData.prototype=Object.create(SpectrumData.prototype),PeakSpectrumData.prototype.constructor=PeakSpectrumData;var HarmonicSpectrumData=function(t,r,e){void 0===t||t<=0?console.error("SpectrumData constructor requires N to be a defined, whole number"):(void 0===r&&(r=Math.PI),PeakSpectrumData.call(this,t),Object.defineProperties(this,{odd_even_ratio:{value:function(){return void 0===this.result.odd_even_ratio&&(void 0===this.f0&&this.spectral_fundamental(this.data,this.sampleRate),this.result.odd_even_ratio=xtract_odd_even_ratio(this.data,this.f0)),this.result.odd_even_ratio}},noisiness:{value:function(){return e.constructor!==PeakSpectrumData?this.result.noisiness=null:this.result.noisiness=xtract_noisiness(this.nonzero_count(),e.nonzero_count()),this.result.noisiness}}}))};HarmonicSpectrumData.prototype=Object.create(PeakSpectrumData.prototype),HarmonicSpectrumData.prototype.constructor=HarmonicSpectrumData,TimeData.prototype.features=[{name:"Minimum",function:"minimum",sub_features:[],parameters:[],returns:"number"},{name:"Maximum",function:"maximum",sub_features:[],parameters:[],returns:"number"},{name:"Sum",function:"sum",sub_features:[],parameters:[],returns:"number"},{name:"Mean",function:"mean",sub_features:[],parameters:[],returns:"number"},{name:"Temporal Centroid",function:"temporal_centroid",sub_features:["energy"],parameters:[{name:"Window Time",unit:"ms",type:"number",minimum:1,maximum:void 0,default:100}],returns:"number"},{name:"Variance",function:"variance",sub_features:["mean"],parameters:[],returns:"number"},{name:"Standard Deviation",function:"standard_deviation",sub_features:["variance"],parameters:[],returns:"number"},{name:"Average Deviation",function:"average_deviation",sub_features:["mean"],parameters:[],returns:"number"},{name:"Skewness",function:"skewness",sub_features:["mean","standard_deviation"],parameters:[],returns:"number"},{name:"Kurtosis",function:"kurtosis",sub_features:["mean","standard_deviation"],parameters:[],returns:"number"},{name:"Zero Crossing Rate",function:"zcr",sub_features:[],parameters:[],returns:"number"},{name:"Crest Factor",function:"crest_factor",sub_features:["maximum","mean"],parameters:[],returns:"number"},{name:"RMS Amplitude",function:"rms_amplitude",sub_features:[],parameters:[],returns:"number"},{name:"Lowest Value",function:"lowest_value",sub_features:[],parameters:[{name:"Threshold",unit:"",type:"number",minimum:void 0,maximum:void 0,default:void 0}],returns:"number"},{name:"Highest Value",function:"highest_value",sub_features:[],parameters:[{name:"Threshold",unit:"",type:"number",minimum:void 0,maximum:void 0,default:void 0}],returns:"number"},{name:"Non-Zero Count",function:"nonzero_count",sub_features:[],parameters:[],returns:"number"},{name:"Fundamental Frequency",function:"f0",sub_features:[],parameters:[],returns:"number"},{name:"Energy",function:"energy",sub_features:[],parameters:[{name:"Window",unit:"ms",type:"number",minimum:1,maximum:void 0,default:100}],returns:"object"},{name:"Spectrum",function:"spectrum",sub_features:[],parameters:[],returns:"SpectrumData"},{name:"DCT",function:"dct",sub_features:[],parameters:[],returns:"array"},{name:"Autocorrelation",function:"autocorrelation",sub_features:[],parameters:[],returns:"array"},{name:"AMDF",function:"amdf",sub_features:[],parameters:[],returns:"array"},{name:"ASDF",function:"asdf",sub_features:[],parameters:[],returns:"array"},{name:"YIN Pitch",function:"yin",sub_features:[],parameters:[],returns:"array"},{name:"Onset Detection",function:"onset",sub_features:[],parameters:[{name:"Frame Size",unit:"samples",type:"number",minimum:1,maximum:void 0,default:1024}],returns:"array"},{name:"Resample",function:"resample",sub_features:[],parameters:[{name:"Target Sample Rate",unit:"Hz",type:"number",minimum:0,maximum:void 0,default:8e3}],returns:"TimeData"}],SpectrumData.prototype.features=[{name:"Minimum",function:"minimum",sub_features:[],parameters:[],returns:"number"},{name:"Maximum",function:"maximum",sub_features:[],parameters:[],returns:"number"},{name:"Sum",function:"sum",sub_features:[],parameters:[],returns:"number"},{name:"Spectral Centroid",function:"spectral_centroid",sub_features:[],parameters:[],returns:"number"},{name:"Spectral Mean",function:"spectral_mean",sub_features:[],parameters:[],returns:"number"},{name:"Spectral Variance",function:"spectral_variance",sub_features:["spectral_mean"],parameters:[],returns:"number"},{name:"Spectral Spread",function:"spectral_spread",sub_features:["spectral_centroid"],parameters:[],returns:"number"},{name:"Spectral Standard Deviation",function:"spectral_standard_deviation",sub_features:["spectral_variance"],parameters:[],returns:"number"},{name:"Spectral Skewness",function:"spectral_skewness",sub_features:["spectral_mean","spectral_standard_deviation"],parameters:[],returns:"number"},{name:"Spectral Kurtosis",function:"spectral_kurtosis",sub_features:["spectral_mean","spectral_standard_deviation"],parameters:[],returns:"number"},{name:"Irregularity K",function:"irregularity_k",sub_features:[],parameters:[],returns:"number"},{name:"Irregularity J",function:"irregularity_j",sub_features:[],parameters:[],returns:"number"},{name:"Tristimulus 1",function:"tristimulus_1",sub_features:["spectral_fundamental"],parameters:[],returns:"number"},{name:"Tristimulus 2",function:"tristimulus_2",sub_features:["spectral_fundamental"],parameters:[],returns:"number"},{name:"Tristimulus 3",function:"tristimulus_3",sub_features:["spectral_fundamental"],parameters:[],returns:"number"},{name:"Smoothness",function:"smoothness",sub_features:[],parameters:[],returns:"number"},{name:"Rolloff",function:"rolloff",sub_features:[],parameters:[{name:"Threshold",unit:"%",type:"number",minimum:0,maximum:100,default:90}],returns:"number"},{name:"Loudness",function:"loudness",sub_features:["bark_coefficients"],parameters:[],returns:"number"},{name:"Sharpness",function:"sharpness",sub_features:["bark_coefficients"],parameters:[],returns:"number"},{name:"Flatness",function:"flatness",sub_features:[],parameters:[],returns:"number"},{name:"Flatness DB",function:"flatness_db",sub_features:["flatness"],parameters:[],returns:"number"},{name:"Tonality",function:"tonality",sub_features:["flatness_db"],parameters:[],returns:"number"},{name:"Spectral Crest Factor",function:"spectral_crest_factor",sub_features:["maximum","spectral_mean"],parameters:[],returns:"number"},{name:"Spectral Slope",function:"spectral_slope",sub_features:[],parameters:[],returns:"number"},{name:"Fundamental Frequency",function:"spectral_fundamental",sub_features:[],parameters:[],returns:"number"},{name:"Non-Zero count",function:"nonzero_count",sub_features:[],parameters:[],returns:"number"},{name:"HPS",function:"hps",sub_features:[],parameters:[],returns:"number"},{name:"MFCC",function:"mfcc",sub_features:[],parameters:[{name:"Band Count",unit:"",type:"number",minimum:0,maximum:void 0,default:26},{name:"Minimum Frequency",unit:"Hz",type:"number",minimum:0,maximum:void 0,default:400},{name:"Maximum Frequency",unit:"Hz",minimum:0,maximum:void 0,default:2e4}],returns:"array"},{name:"Chroma",function:"chroma",sub_features:[],parameters:[{name:"nbins",unit:"",type:"number",minimum:2,maximum:void 0,default:12},{name:"A440",unit:"",type:"number",minimum:220,maximum:880,default:440},{name:"f_ctr",unit:"",type:"number",minimum:void 0,maximum:void 0,default:1e3},{name:"octwidth",unit:"",type:"number",minimum:void 0,maximum:void 0,default:1}],returns:"array"},{name:"DCT",function:"dct",sub_features:[],parameters:[],returns:"array"},{name:"Bark Coefficients",function:"bark_coefficients",sub_features:[],parameters:[{name:"Band Count",unit:"",type:"number",minimum:0,maximum:26,default:26}],returns:"array"},{name:"Peak Spectrum",function:"peak_spectrum",sub_features:[],parameters:[{name:"Threshold",unit:"",type:"number",minimum:0,maximum:100,default:30}],returns:"PeakSpectrumData"}],PeakSpectrumData.prototype.features=SpectrumData.prototype.features.concat([{name:"Spectral Inharmonicity",function:"spectral_inharmonicity",sub_features:["f0"],parameters:[],returns:"number"},{name:"Harmonic Spectrum",function:"harmonic_spectrum",sub_features:[],parameters:[{name:"Threshold",unit:"",type:"number",minimum:0,maximum:100,default:30}],returns:"HarmonicSpectrumData"}]),HarmonicSpectrumData.prototype.features=PeakSpectrumData.prototype.features.concat([{name:"Odd Even Ration",function:"odd_even_ratio",sub_features:[],parameters:[],returns:"number"}]),"undefined"!=typeof AnalyserNode&&(AnalyserNode.prototype.timeData=void 0,AnalyserNode.prototype.spectrumData=void 0,AnalyserNode.prototype.callbackObject=void 0,AnalyserNode.prototype.fooGain=void 0,AnalyserNode.prototype.getXtractData=function(){void 0!==this.timeData&&void 0!==this.scpectrumData||(this.timeData=new TimeData(this.fftSize,this.context.sampleRate),this.spectrumData=new SpectrumData(this.frequencyBinCount,this.context.sampleRate));var t,r=new Float32Array(this.fftSize);if(this.getFloatTimeDomainData)this.getFloatTimeDomainData(r);else{var e=new Uint8Array(this.fftSize);for(this.getByteTimeDomainData(e),t=0;t<this.fftSize;t++)r[t]=e[t],r[t]=r[t]/127.5-1}this.timeData.copyDataFrom(r),this.timeData.result.spectrum=this.spectrumData;var a=new Float32Array(this.frequencyBinCount);for(this.getFloatFrequencyData(a),t=0;t<this.frequencyBinCount;t++)a[t]=Math.pow(10,a[t]/20);return this.spectrumData.copyDataFrom(a),this.timeData},AnalyserNode.prototype.previousFrame=void 0,AnalyserNode.prototype.previousResult=void 0,AnalyserNode.prototype.frameCallback=function(t,r){void 0===this.callbackObject&&(this.callbackObject=this.context.createScriptProcessor(this.fftSize,1,1),this.connect(this.callbackObject));var e=t,a=r,n=this;this.callbackObject.onaudioprocess=function(t){var r=n.getXtractData();this.previousResult=e.call(a,r,this.previousFrame,this.previousResult),this.previousFrame=r;var s=t.outputBuffer.length,i=new Float32Array(s),u=this.previousResult;"number"!=typeof this.previousResult&&(u=0);for(var o=0;o<s;o++)i[o]=u;t.outputBuffer.copyToChannel(i,0,0)},this.fooGain||(this.fooGain=this.context.createGain(),this.fooGain.gain.value=0,this.callbackObject.connect(this.fooGain),this.fooGain.connect(this.context.destination))},AnalyserNode.prototype.clearCallback=function(){this.disconnect(this.callbackObject),this.callbackObject.onaudioprocess=void 0},AnalyserNode.prototype.xtractFrame=function(t,r){t.call(r,this.getXtractData())}),"undefined"!=typeof AudioBuffer&&(AudioBuffer.prototype.xtract_get_data_frames=function(t,r){void 0===r&&(r=t),function(){if(!xtract_assert_positive_integer(t))throw"xtract_get_data_frames requires the frame_size to be defined, positive integer";if(!xtract_assert_positive_integer(r))throw"xtract_get_data_frames requires the hop_size to be a positive integer"}(),this.frames=[];this.length;for(var e=this.xtract_get_number_of_frames(r),a=0;a<this.numberOfChannels;a++){var n=this.getChannelData(a);this.frames[a]=[];for(var s=0;s<e;s++){var i=new TimeData(t,this.sampleRate);i.copyDataFrom(n.subarray(r*s,r*s+t)),this.frames[a].push(i),i=void 0}n=void 0}return this.frames},AudioBuffer.prototype.xtract_get_number_of_frames=function(t){return xtract_get_number_of_frames(this,t)},AudioBuffer.prototype.xtract_get_frame=function(t,r,e,a){if(function(){if("object"!=typeof t||t.constructor!==Float32Array)throw"dst must be a Float32Array object equal in length to hop_size";if(!xtract_assert_positive_integer(r))throw"xtract_get_frame requires the channel to be an integer value";if(!xtract_assert_positive_integer(e))throw"xtract_get_frame requires the index to be an integer value";if(!xtract_assert_positive_integer(a))throw"xtract_get_frame requires the frame_size to be defined, positive integer"}(),r<0||r>this.numberOfChannels)throw"channel number "+r+" out of bounds";var n=this.xtract_get_number_of_frames(a);if(e<0||e>=n)throw"index number "+e+" out of bounds";return this.copyFromChannel(t,r,a*e)},AudioBuffer.prototype.xtract_process_frame_data=function(){throw"AudioBuffer::xtract_process_frame_data has been deprecated"});